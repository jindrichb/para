 
%izoentalpy
%x = [0.0596625863368935,1.33734804734661,2.67363148313366,4.00994895211589,0.0208481263490264,6.68260087979294,8.01916487247992,9.35506641479400,10.6914901605829,12.0272598012626,12.6415319480927,13.3211908306046,14.0777254458752,14.9249702161490,15.8802902239537,16.9657842765717,18.2100158726891,19.6505636426339,21.3378826453612,23.3413361942786,25.7589688063889,28.7340394408637,32.4844816551725,37.3588492212431,43.9514227287392,53.3650808538606,67.9034750158168,93.3163715508279,149.093271022026];
%y = [0.109096910381577,0.123511284434667,0.123513322551503,0.123513120402860,19.3489692119159,0.123512623647997,0.123508723870194,0.123514947000858,0.123513391757904,0.123519202230300,0.117539325032257,0.111565347073321,0.105591279926749,0.0996171301066625,0.0936429039062229,0.0876686074559517,0.0816942467976774,0.0757198279805562,0.0697453571886430,0.0637708409140598,0.0577962861971306,0.0518217009666161,0.0458470945325131,0.0398724783160212,0.0338978669537835,0.0279232799908939,0.0219487444319897,0.0159742979893039,0.00999998778935803];
%x = [0.00132138193705085,0.00135598575285934,0.00139634221288956,0.00144513007517989,0.00150779919911429,0.00480051505703692,0.0103536738838334,0.0172160179465653,0.0257289456447230,0.0362181483884640,0.0490456395866818,0.0646217723563322,0.0834212111362496,0.105989252016604,0.132953063780901,0.165037224885206,0.203070645560556,0.248013691013976,0.300959574182861,0.363175076864713,0.436096840463096,0.521385643573612,0.620933840567853,0.736906352468461,0.871779746703340,1.02839194249793,1.20996304867427,1.42017957149094,1.66323971876149,1.94393661518527,2.26772746411910,2.64078824618616,3.07020460014644,3.56397215785555,4.13125234811159,4.78237565569747,5.52908087701531,6.38476833317533,7.36454152220901,8.48550437812298,9.76733994586697,11.2317533021704,12.9040923370017,14.8123860980961,16.9888109164242,19.4696114952476,22.2953152598977,25.5120001711568,29.1742449954634,33.3367450489352];
%y = [800.720412889023,635.459451694306,475.024385325021,320.246371378186,172.032919635107,74.4912022652596,46.6454893208762,32.4961919061268,23.8338939975951,18.0438084149721,13.9634451342273,10.9837199533898,8.75025009040265,7.04259393291318,5.71632097219741,4.67293817968612,3.84340061136559,3.17785171730115,2.63980027407035,2.20185013521302,1.84332941086484,1.54828012300164,1.30434904971256,1.10184494283179,0.933100763395546,0.792002290458008,0.673662306596529,0.574125978421548,0.490187152659330,0.419228915016181,0.359109208494088,0.308070714487867,0.264654199994020,0.227656924270936,0.196073714940908,0.169070972152762,0.145950274409571,0.126124115787121,0.109101174959409,0.0944672515845870,0.0818696688025431,0.0710155401790806,0.0616509730360381,0.0535645345629308,0.0465742538982754,0.0405258890737692,0.0352885943747273,0.0307497211726121,0.0268104852854766,0.0233928992012572];
x = [0.00112039191283060,0.00112429028450500,0.00112827193623349,0.00113234000315060,0.00113649776245620,0.00114074868947105,0.00114509652113107,0.00114954532708841,0.00115409958819572,0.00115876428175767,0.00116354497262414,0.00116844790910111,0.00117348012291945,0.00117864953324236,0.00118396505585721,0.00118943671994753,0.00119507579557314,0.00120089493476598,0.00120690832868973,0.00132509344435316,0.00861482432351779,0.0150071345230781,0.0218183543998321,0.0292613849553993,0.0374489972129597,0.0464670853019108,0.0563948463173266,0.0673096720956078,0.0792885951813524,0.0924124013866685,0.106769152602866,0.122444113771491,0.139540080684447,0.158149363362978,0.178383957677489,0.200354560827269,0.224178893577518,0.249984597660310,0.277908893277892,0.308090979810104,0.340679269541576,0.340679269541576,0.366027668688450,0.393459634081877,0.423168245242866,0.455369120733081,0.490288016560025,0.528191693010501,0.569361326044722,0.614109088087494,0.662797695408307,0.715807830338654,0.773562613638763,0.836545810134965,0.905293676529886,0.980399047448648,1.06251461844667,1.15237541784401,1.25081555033872,1.35873369217615,1.47717370790016,1.60725857086257,1.75030001571065,1.90776046065152,2.08122681815797,2.27253192829105,2.48378983098750,2.71725533326834,2.97561005650505,3.26180597529005,3.57920336629704,3.93159340873817,4.32337730499286,4.75934038235831,5.24522198484067,5.78733258881517,6.39302201590351,7.07055707608508,7.82942797914794,8.68071260589879,9.63687466995482,10.7126571081647,11.9241593789341,13.2910756614875,14.8352454149865,16.5826164389134,18.5630080040788,20.8110406627191,23.3678254477027,26.2794111781991,29.6010243585552];
y = [849.815068857331,805.383715974338,761.058321127267,716.843708668816,672.744802381729,628.766627180511,584.914310844922,541.193085785955,497.608290845062,454.165373127416,410.869889869935,367.727510344972,324.744017800390,281.925311436969,239.277408423925,196.806445953496,154.518683335462,112.420504132547,70.5184183376408,28.7176499974871,17.2115836629792,13.1085422129803,10.5726161839357,8.78789508659867,7.44702752265711,6.39822134514323,5.55472235619199,4.86235073108280,4.28509738385617,3.79775595434060,3.38198950799363,3.02433618652581,2.71427025711819,2.44389742015664,2.20676373946534,1.99780024371307,1.81287973766294,1.64859520779727,1.50212132583304,1.37113135083138,1.25365863271296,1.25365863271296,1.17561586372011,1.10163104172193,1.03153797093705,0.965170455584127,0.902389999178705,0.843030405939425,0.786953179381832,0.734019823021465,0.684077990725422,0.637003035657689,0.592670310982251,0.550948245038873,0.511712190991538,0.474844426828459,0.440234155362065,0.407770579404791,0.377342901769073,0.348854174915786,0.322200526481582,0.297291933751567,0.274031449186619,0.252329050071839,0.232105100928660,0.213276503866412,0.195760160994415,0.179486824070440,0.164380320028037,0.150373131831028,0.137399473649300,0.125397022064841,0.114303453659647,0.104065101045989,0.0946239688210008,0.0859298520090644,0.0779325456345641,0.0705861727370239,0.0638465875620207,0.0576705099581616,0.0520189877891921,0.0468530689188578,0.0421398604321006,0.0378438726047768,0.0339348093309121,0.0303823745045293,0.0271588688287378,0.0242383242127014,0.0215956381686113,0.0192091706207711,0.0170572814934839];


%[x,y] = dist_filtr(x1,y1);

%function [x,y] = dist_filtr(x_in,y_in)
%d_to_zero = sqrt(x_in.^2 + y_in.^2);
diff_x = diff(log10(x));
diff_y = diff(log10(y));

diffs = sqrt(diff_x.^2 + diff_y.^2);
m1 = mean(diffs);
m2 = mean(diffs(diffs>m1));
m = m2;
%first and last values always stay
idx0 = [diffs < m,true];
idx1 = [true,diffs < m];


x_o = x(idx0|idx1);
y_o = y(idx0|idx1);

% figure
% plot(x,y)
% hold on
% plot(x_o,y_o)
% hold off
%end


